"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3552],{98225:function(re,A,m){m.r(A),m.d(A,{default:function(){return ce}});var e=m(32735),g=m(13478),k=m(60216),c=m.n(k),f=m(5636),t=m(39161),h=m(57269),N=m(74552),s=m(60255),L=m(83281),b=m(5173),P=(0,b.Ry)().shape({code:(0,b.Z_)().required(),displayName:(0,b.Z_)().max(50,"Settings.locales.modal.locales.displayName.error").required(g.translatedErrors.required)}),T=m(4409),S=m(9494);const G=async(a,n,o)=>{try{const l=await(0,g.request)(`/i18n/locales/${a}`,{method:"PUT",body:n});return o({type:"success",message:{id:(0,s.O)("Settings.locales.modal.edit.success")}}),l}catch{return o({type:"warning",message:{id:"notification.error"}}),null}};var V=()=>{const[a,n]=(0,e.useState)(!1),o=(0,T.useDispatch)(),l=(0,g.useNotification)();return{isEditing:a,editLocale:async(d,r)=>{n(!0);const u=await G(d,r,l);o({type:S.OT,editedLocale:u}),n(!1)}}},H=m(84968);const U=async a=>{try{return await(0,g.request)("/i18n/iso-locales",{method:"GET"})}catch{return a({type:"warning",message:{id:"notification.error"}}),[]}};var R=()=>{const{formatMessage:a}=(0,f.useIntl)(),{notifyStatus:n}=(0,t.useNotifyAT)(),o=(0,g.useNotification)(),{isLoading:l,data:i}=(0,H.useQuery)("default-locales",()=>U(o).then(d=>(n(a({id:(0,s.O)("Settings.locales.modal.locales.loaded"),defaultMessage:"The locales have been successfully loaded."})),d)));return{defaultLocales:i,isLoading:l}};const x=({locale:a})=>{const{formatMessage:n}=(0,f.useIntl)(),{values:o,handleChange:l,errors:i}=(0,L.useFormikContext)(),{defaultLocales:d,isLoading:r}=R(),u=!r&&d.find(y=>y.code===a.code);return e.createElement(t.Grid,{gap:4},e.createElement(t.GridItem,{col:6},e.createElement(t.Select,{label:n({id:(0,s.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:u?.code||a.code,disabled:!0},e.createElement(t.Option,{value:u?.code||a.code},u?.name||a.code))),e.createElement(t.GridItem,{col:6},e.createElement(t.TextInput,{name:"displayName",label:n({id:(0,s.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:n({id:(0,s.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?n({id:(0,s.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:o.displayName,onChange:l})))};var Z=x;x.propTypes={locale:c().shape({id:c().number.isRequired,name:c().string.isRequired,code:c().string.isRequired,isDefault:c().bool.isRequired}).isRequired};const I=({isDefaultLocale:a})=>{const{values:n,setFieldValue:o}=(0,L.useFormikContext)(),{formatMessage:l}=(0,f.useIntl)();return e.createElement(t.Checkbox,{name:"isDefault",hint:l({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>o("isDefault",!n.isDefault),value:n.isDefault,disabled:a},l({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};I.propTypes={isDefaultLocale:c().bool.isRequired};var j=I;const M=({locale:a,onClose:n})=>{const{refetchPermissions:o}=(0,g.useRBACProvider)(),{isEditing:l,editLocale:i}=V(),{formatMessage:d}=(0,f.useIntl)(),r=async({displayName:u,isDefault:y})=>{await i(a.id,{name:u,isDefault:y}),await o()};return e.createElement(t.ModalLayout,{onClose:n,labelledBy:"edit-locale-title"},e.createElement(L.Formik,{initialValues:{code:a?.code,displayName:a?.name||"",isDefault:Boolean(a?.isDefault)},onSubmit:r,validationSchema:P},e.createElement(g.Form,null,e.createElement(t.ModalHeader,null,e.createElement(t.Typography,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"edit-locale-title"},d({id:(0,s.O)("Settings.list.actions.edit"),defaultMessage:"Edit a locale"}))),e.createElement(t.ModalBody,null,e.createElement(t.TabGroup,{label:d({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(t.Flex,{justifyContent:"space-between"},e.createElement(t.Typography,{as:"h2"},d({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(t.Tabs,null,e.createElement(t.Tab,null,d({id:(0,s.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(t.Tab,null,d({id:(0,s.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement(t.Divider,null),e.createElement(t.Box,{paddingTop:7,paddingBottom:7},e.createElement(t.TabPanels,null,e.createElement(t.TabPanel,null,e.createElement(Z,{locale:a})),e.createElement(t.TabPanel,null,e.createElement(j,{isDefaultLocale:Boolean(a&&a.isDefault)})))))),e.createElement(t.ModalFooter,{startActions:e.createElement(t.Button,{variant:"tertiary",onClick:n},d({id:"app.components.Button.cancel"})),endActions:e.createElement(t.Button,{type:"submit",startIcon:e.createElement(h.Check,null),disabled:l},d({id:"global.save"}))}))))};M.defaultProps={locale:void 0},M.propTypes={locale:c().shape({id:c().number.isRequired,name:c().string.isRequired,code:c().string.isRequired,isDefault:c().bool.isRequired}),onClose:c().func.isRequired};var W=M;const z=async(a,n)=>{try{const o=await(0,g.request)(`/i18n/locales/${a}`,{method:"DELETE"});return n({type:"success",message:{id:(0,s.O)("Settings.locales.modal.delete.success")}}),o}catch(o){return n({type:"warning",message:{id:"notification.error"}}),o}};var $=()=>{const[a,n]=(0,e.useState)(!1),o=(0,T.useDispatch)(),l=(0,g.useNotification)();return{isDeleting:a,deleteLocale:async d=>{n(!0),await z(d,l),o({type:S.HC,id:d}),n(!1)}}};const D=({localeToDelete:a,onClose:n})=>{const{isDeleting:o,deleteLocale:l}=$(),i=Boolean(a),d=()=>l(a.id).then(n);return e.createElement(g.ConfirmDialog,{isConfirmButtonLoading:o,onConfirm:d,onToggleDialog:n,isOpen:i})};D.defaultProps={localeToDelete:void 0},D.propTypes={localeToDelete:c().shape({id:c().number.isRequired}),onClose:c().func.isRequired};var Q=D,J=m(33795),K=m.n(J);const X=async({code:a,name:n,isDefault:o},l)=>{const i=await(0,g.request)("/i18n/locales",{method:"POST",body:{name:n,code:a,isDefault:o}});return l({type:"success",message:{id:(0,s.O)("Settings.locales.modal.create.success")}}),i};var Y=()=>{const[a,n]=(0,e.useState)(!1),o=(0,T.useDispatch)(),l=(0,g.useNotification)();return{isAdding:a,addLocale:async d=>{n(!0);try{const r=await X(d,l);o({type:S.xz,newLocale:r})}catch(r){const u=K()(r,"response.payload.message",null);throw u&&u.includes("already exists")?l({type:"warning",message:{id:(0,s.O)("Settings.locales.modal.create.alreadyExist")}}):l({type:"warning",message:{id:"notification.error"}}),r}finally{n(!1)}}}};const O=e.memo(({value:a,onClear:n,onLocaleChange:o,error:l})=>{const{formatMessage:i}=(0,f.useIntl)(),{defaultLocales:d,isLoading:r}=R(),{locales:u}=(0,N.Z)(),y=(d||[]).map(p=>({label:p.name,value:p.code})).filter(({value:p})=>{const E=u.find(({code:C})=>C===p);return!E||E.code===a}),v=a||"";return e.createElement(t.Combobox,{"aria-busy":r,error:l,label:i({id:(0,s.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:v,onClear:a?n:void 0,onChange:p=>{const E=y.find(C=>C.value===p);E&&o({code:E.value,displayName:E.label})},placeholder:i({id:"components.placeholder.select",defaultMessage:"Select"})},y.map(p=>e.createElement(t.ComboboxOption,{value:p.value,key:p.value},p.label)))});O.defaultProps={error:void 0,value:void 0,onClear(){},onLocaleChange:()=>{}},O.propTypes={error:c().string,onClear:c().func,onLocaleChange:c().func,value:c().string};var _=O,ee=()=>{const{formatMessage:a}=(0,f.useIntl)(),{values:n,handleChange:o,setFieldValue:l,errors:i}=(0,L.useFormikContext)(),d=(0,e.useCallback)(u=>{l("displayName",u.displayName),l("code",u.code)},[l]),r=(0,e.useCallback)(()=>{l("displayName",""),l("code","")},[l]);return e.createElement(t.Grid,{gap:4},e.createElement(t.GridItem,{col:6},e.createElement(_,{error:i.code,value:n.code,onLocaleChange:d,onClear:r})),e.createElement(t.GridItem,{col:6},e.createElement(t.TextInput,{name:"displayName",label:a({id:(0,s.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:a({id:(0,s.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?a({id:(0,s.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:n.displayName,onChange:o})))},te=()=>{const{values:a,setFieldValue:n}=(0,L.useFormikContext)(),{formatMessage:o}=(0,f.useIntl)();return e.createElement(t.Checkbox,{hint:o({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>n("isDefault",!a.isDefault),value:a.isDefault},o({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};const ae={code:"",displayName:"",isDefault:!1},w=({onClose:a})=>{const{isAdding:n,addLocale:o}=Y(),{formatMessage:l}=(0,f.useIntl)(),{refetchPermissions:i}=(0,g.useRBACProvider)(),d=async r=>{await o({code:r.code,name:r.displayName,isDefault:r.isDefault}),await i()};return e.createElement(t.ModalLayout,{onClose:a,labelledBy:"add-locale-title"},e.createElement(L.Formik,{initialValues:ae,onSubmit:d,validationSchema:P,validateOnChange:!1},e.createElement(g.Form,null,e.createElement(t.ModalHeader,null,e.createElement(t.Typography,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"add-locale-title"},l({id:(0,s.O)("Settings.list.actions.add"),defaultMessage:"Add new locale"}))),e.createElement(t.ModalBody,null,e.createElement(t.TabGroup,{label:l({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(t.Flex,{justifyContent:"space-between"},e.createElement(t.Typography,{as:"h2",variant:"beta"},l({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(t.Tabs,null,e.createElement(t.Tab,null,l({id:(0,s.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(t.Tab,null,l({id:(0,s.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement(t.Divider,null),e.createElement(t.Box,{paddingTop:7,paddingBottom:7},e.createElement(t.TabPanels,null,e.createElement(t.TabPanel,null,e.createElement(ee,null)),e.createElement(t.TabPanel,null,e.createElement(te,null)))))),e.createElement(t.ModalFooter,{startActions:e.createElement(t.Button,{variant:"tertiary",onClick:a},l({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(t.Button,{type:"submit",startIcon:e.createElement(h.Check,null),disabled:n},l({id:"global.save",defaultMessage:"Save"}))}))))};w.propTypes={onClose:c().func.isRequired};var le=w;const B=({locales:a,onDeleteLocale:n,onEditLocale:o})=>{const{formatMessage:l}=(0,f.useIntl)();return e.createElement(t.Table,{colCount:4,rowCount:a.length+1},e.createElement(t.Thead,null,e.createElement(t.Tr,null,e.createElement(t.Th,null,e.createElement(t.Typography,{variant:"sigma",textColor:"neutral600"},l({id:(0,s.O)("Settings.locales.row.id")}))),e.createElement(t.Th,null,e.createElement(t.Typography,{variant:"sigma",textColor:"neutral600"},l({id:(0,s.O)("Settings.locales.row.displayName")}))),e.createElement(t.Th,null,e.createElement(t.Typography,{variant:"sigma",textColor:"neutral600"},l({id:(0,s.O)("Settings.locales.row.default-locale")}))),e.createElement(t.Th,null,e.createElement(t.VisuallyHidden,null,"Actions")))),e.createElement(t.Tbody,null,a.map(i=>e.createElement(t.Tr,{key:i.id,...(0,g.onRowClick)({fn:()=>o(i),condition:o})},e.createElement(t.Td,null,e.createElement(t.Typography,{textColor:"neutral800"},i.id)),e.createElement(t.Td,null,e.createElement(t.Typography,{textColor:"neutral800"},i.name)),e.createElement(t.Td,null,e.createElement(t.Typography,{textColor:"neutral800"},i.isDefault?l({id:(0,s.O)("Settings.locales.default")}):null)),e.createElement(t.Td,null,e.createElement(t.Flex,{gap:1,justifyContent:"flex-end",...g.stopPropagation},o&&e.createElement(t.IconButton,{onClick:()=>o(i),label:l({id:(0,s.O)("Settings.list.actions.edit")}),icon:e.createElement(h.Pencil,null),noBorder:!0}),n&&!i.isDefault&&e.createElement(t.IconButton,{onClick:()=>n(i),label:l({id:(0,s.O)("Settings.list.actions.delete")}),icon:e.createElement(h.Trash,null),noBorder:!0})))))))};B.defaultProps={locales:[],onDeleteLocale:void 0,onEditLocale:void 0},B.propTypes={locales:c().array,onDeleteLocale:c().func,onEditLocale:c().func};var ne=B;const F=({canUpdateLocale:a,canDeleteLocale:n,onToggleCreateModal:o,isCreating:l})=>{const[i,d]=(0,e.useState)(),[r,u]=(0,e.useState)(),{locales:y}=(0,N.Z)(),{formatMessage:v}=(0,f.useIntl)();(0,g.useFocusWhenNavigate)();const p=()=>d(void 0),E=n?d:void 0,C=()=>u(void 0),de=a?u:void 0;return e.createElement(t.Main,{tabIndex:-1},e.createElement(t.HeaderLayout,{primaryAction:e.createElement(t.Button,{startIcon:e.createElement(h.Plus,null),onClick:o,size:"S"},v({id:(0,s.O)("Settings.list.actions.add")})),title:v({id:(0,s.O)("plugin.name")}),subtitle:v({id:(0,s.O)("Settings.list.description")})}),e.createElement(t.ContentLayout,null,y?.length>0?e.createElement(ne,{locales:y,onDeleteLocale:E,onEditLocale:de}):e.createElement(t.EmptyStateLayout,{icon:e.createElement(h.EmptyDocuments,{width:void 0,height:void 0}),content:v({id:(0,s.O)("Settings.list.empty.title")}),action:o?e.createElement(t.Button,{variant:"secondary",startIcon:e.createElement(h.Plus,null),onClick:o},v({id:(0,s.O)("Settings.list.actions.add")})):null})),l&&e.createElement(le,{onClose:o}),r&&e.createElement(W,{onClose:C,locale:r}),e.createElement(Q,{localeToDelete:i,onClose:p}))};F.defaultProps={onToggleCreateModal:void 0},F.propTypes={canUpdateLocale:c().bool.isRequired,canDeleteLocale:c().bool.isRequired,onToggleCreateModal:c().func,isCreating:c().bool.isRequired};var oe=F;const q=({canReadLocale:a,canCreateLocale:n,canDeleteLocale:o,canUpdateLocale:l})=>{const[i,d]=(0,e.useState)(!1),r=n?()=>d(u=>!u):void 0;return a?e.createElement(oe,{canUpdateLocale:l,canDeleteLocale:o,onToggleCreateModal:r,isCreating:i}):null};q.propTypes={canReadLocale:c().bool.isRequired,canCreateLocale:c().bool.isRequired,canUpdateLocale:c().bool.isRequired,canDeleteLocale:c().bool.isRequired};var se=q,ie=m(58347),ce=()=>{const{isLoading:a,allowedActions:{canRead:n,canUpdate:o,canCreate:l,canDelete:i}}=(0,g.useRBAC)(ie.Z);return a?null:e.createElement(se,{canReadLocale:n,canCreateLocale:l,canUpdateLocale:o,canDeleteLocale:i})}}}]);
