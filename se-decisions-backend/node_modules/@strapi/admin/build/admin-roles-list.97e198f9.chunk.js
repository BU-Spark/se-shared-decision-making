"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3455],{67249:function(N,M,t){t.r(M),t.d(M,{default:function(){return Ee}});var e=t(32735),n=t(43383),p=t(83983),h=t(47765),y=t(68625),L=t(4038),P=t(19406),f=t(27649),d=t(82055),v=t(41415),g=t(99223),U=t(17e3),K=t(56755),G=t(73269),X=t(33827),V=t(94547),R=t(19786),O=t(49372),J=t(3685),Y=t(35658),k=t(33795),w=t.n(k),q=t(9347),$=t(67879),_=t(53038),ee=t(67927),te=()=>"todo empty role",ne=t(60216),A=t.n(ne),le=t(87933),ae=t(72850),se=t(50563);const H=({id:l,name:c,description:a,usersCount:u,icons:m,rowIndex:r})=>{const{formatMessage:D}=(0,$.Z)(),T=D({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:u});return e.createElement(V.Tr,{"aria-rowindex":r,key:l,...(0,n.X7)({fn:m[1].onClick})},e.createElement(R.Td,{maxWidth:(0,n.Q1)(130)},e.createElement(O.Z,{ellipsis:!0,textColor:"neutral800"},c)),e.createElement(R.Td,{maxWidth:(0,n.Q1)(250)},e.createElement(O.Z,{ellipsis:!0,textColor:"neutral800"},a)),e.createElement(R.Td,null,e.createElement(O.Z,{textColor:"neutral800"},T)),e.createElement(R.Td,null,e.createElement(le.k,{justifyContent:"flex-end",...n.UW},m.map((o,C)=>o?e.createElement(ae.x,{key:o.label,paddingLeft:C===0?0:1},e.createElement(se.h,{onClick:o.onClick,label:o.label,noBorder:!0,icon:o.icon})):null))))};H.propTypes={id:A().number.isRequired,name:A().string.isRequired,description:A().string.isRequired,usersCount:A().number.isRequired,icons:A().array.isRequired,rowIndex:A().number.isRequired};var oe=H,re=t(97889);const ie={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1};var de=(l,c)=>(0,re.ZP)(l,a=>{switch(c.type){case"ON_REMOVE_ROLES":{a.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{a.shouldRefetchData=!0,a.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{a.shouldRefetchData=!1,a.roleToDelete=null,a.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{a.roleToDelete=c.id;break}default:return a}});const ce=()=>{(0,n.go)();const{isLoading:l,allowedActions:{canCreate:c,canDelete:a,canRead:u,canUpdate:m}}=(0,n.ss)(p.Z.settings.roles),{getData:r,roles:D,isLoading:T}=(0,ee.bF)(!1),[{query:o}]=(0,n.Kx)(),C=o?._q||"",x=(0,q.Z)(D,C,{keys:["name","description"]});return(0,e.useEffect)(()=>{!l&&u&&r()},[l,u,r]),{isLoadingForPermissions:l,canCreate:c,canDelete:a,canRead:u,canUpdate:m,isLoading:T,getData:r,sortedRoles:x,roles:D}},ue=({getData:l,canCreate:c,canDelete:a,canUpdate:u})=>{const{formatMessage:m}=(0,$.Z)(),r=(0,n.lm)(),[D,T]=(0,e.useState)(!1),{push:o}=(0,_.k6)(),[{selectedRoles:C,showModalConfirmButtonLoading:x,roleToDelete:j},B]=(0,e.useReducer)(de,ie),{post:S}=(0,n.tg)(),F=async()=>{try{B({type:"ON_REMOVE_ROLES"}),await S("/admin/roles/batch-delete",{ids:[j]}),await l(),B({type:"RESET_DATA_TO_DELETE"})}catch(s){const i=w()(s,["response","payload","data","ids"],null);if(i&&Array.isArray(i)){const pe=i.join(`
`);r({type:"warning",message:pe})}else r({type:"warning",message:{id:"notification.error"}})}E()},Z=(0,e.useCallback)(s=>{o(`/settings/roles/duplicate/${s}`)},[o]),b=()=>o("/settings/roles/new"),I=(0,e.useCallback)(s=>{B({type:"SET_ROLE_TO_DELETE",id:s}),E()},[]),E=()=>T(s=>!s),W=(0,e.useCallback)(s=>{o(`/settings/roles/${s}`)},[o]),Q=(0,e.useCallback)((s,i)=>{s.preventDefault(),s.stopPropagation(),i.usersCount?r({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):I(i.id)},[r,I]),z=(0,e.useCallback)((s,i)=>{s.preventDefault(),s.stopPropagation(),Z(i.id)},[Z]),ge=(0,e.useCallback)(s=>[...c?[{onClick:i=>z(i,s),label:m({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(h.Z,null)}]:[],...u?[{onClick:()=>W(s.id),label:m({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(y.Z,null)}]:[],...a?[{onClick:i=>Q(i,s),label:m({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(L.Z,null)}]:[]],[m,Q,z,W,c,u,a]);return{handleNewRoleClick:b,getIcons:ge,selectedRoles:C,isWarningDeleteAllOpened:D,showModalConfirmButtonLoading:x,handleToggleModal:E,handleDeleteData:F}};var me=()=>{const{formatMessage:l}=(0,$.Z)(),{isLoadingForPermissions:c,canCreate:a,canRead:u,canDelete:m,canUpdate:r,isLoading:D,getData:T,sortedRoles:o}=ce(),{handleNewRoleClick:C,getIcons:x,isWarningDeleteAllOpened:j,showModalConfirmButtonLoading:B,handleToggleModal:S,handleDeleteData:F}=ue({getData:T,canCreate:a,canDelete:m,canUpdate:r}),Z=o.length+1,b=6;if(c)return e.createElement(f.o,null,e.createElement(n.dO,null));const I=l({id:"global.roles",defaultMessage:"roles"});return e.createElement(f.o,null,e.createElement(n.SL,{name:"Roles"}),e.createElement(d.T,{primaryAction:a?e.createElement(v.z,{onClick:C,startIcon:e.createElement(P.Z,null),size:"S"},l({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:I,subtitle:l({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),u&&e.createElement(g.Z,{startActions:e.createElement(n.m,{label:l({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:I})})}),u&&e.createElement(U.D,null,e.createElement(K.i,{colCount:b,rowCount:Z,footer:a?e.createElement(G.c,{onClick:C,icon:e.createElement(P.Z,null)},l({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(X.h,null,e.createElement(V.Tr,{"aria-rowindex":1},e.createElement(R.Th,null,e.createElement(O.Z,{variant:"sigma",textColor:"neutral600"},l({id:"global.name",defaultMessage:"Name"}))),e.createElement(R.Th,null,e.createElement(O.Z,{variant:"sigma",textColor:"neutral600"},l({id:"global.description",defaultMessage:"Description"}))),e.createElement(R.Th,null,e.createElement(O.Z,{variant:"sigma",textColor:"neutral600"},l({id:"global.users",defaultMessage:"Users"}))),e.createElement(R.Th,null,e.createElement(J.T,null,l({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Y.p,null,o?.map((E,W)=>e.createElement(oe,{key:E.id,id:E.id,name:E.name,description:E.description,usersCount:E.usersCount,icons:x(E),rowIndex:W+2})))),!Z&&!D&&e.createElement(te,null)),e.createElement(n.QH,{isOpen:j,onConfirm:F,isConfirmButtonLoading:B,onToggleDialog:S}))},Ee=()=>e.createElement(n.O4,{permissions:p.Z.settings.roles.main},e.createElement(me,null))},99223:function(N,M,t){t.d(M,{Z:function(){return f}});var e=t(32735),n=t(60216),p=t(8471),h=t(72850),y=t(87933);const L=(0,p.ZP)(y.k)`
  & > * + * {
    margin-left: ${({theme:d})=>d.spaces[2]};
  }

  margin-left: ${({pullRight:d})=>d?"auto":void 0};
`,P=(0,p.ZP)(L)`
  flex-shrink: 0;
`,f=({startActions:d,endActions:v})=>d||v?e.createElement(h.x,{paddingLeft:10,paddingRight:10},e.createElement(h.x,{paddingBottom:4},e.createElement(y.k,{justifyContent:"space-between",alignItems:"flex-start"},d&&e.createElement(L,{wrap:"wrap"},d),v&&e.createElement(P,{pullRight:!0},v)))):null;f.defaultProps={endActions:void 0,startActions:void 0},f.propTypes={endActions:n.node,startActions:n.node}},73269:function(N,M,t){t.d(M,{c:function(){return v}});var e=t(32735),n=t(60216),p=t(8471),h=t(72850),y=t(9026),L=t(87933),P=t(49372);const f=(0,p.ZP)(h.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:g})=>g.colors.primary600};
  }
`,d=(0,p.ZP)(h.x)`
  border-radius: 0 0 ${({theme:g})=>g.borderRadius} ${({theme:g})=>g.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,v=({children:g,icon:U,...K})=>e.createElement("div",null,e.createElement(y.i,null),e.createElement(d,{as:"button",background:"primary100",padding:5,...K},e.createElement(L.k,null,e.createElement(f,{"aria-hidden":!0,background:"primary200"},U),e.createElement(h.x,{paddingLeft:3},e.createElement(P.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600"},g)))));v.propTypes={children:n.string.isRequired,icon:n.node.isRequired}}}]);
