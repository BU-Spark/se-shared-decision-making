"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[9497],{9972:function(Y,E,t){t.r(E),t.d(E,{default:function(){return le}});var e=t(32735),o=t(8471),r=t(43383),F=t(67879),I=t(92802),H=t(23940),L=t.n(H),v=t(20108),A=t(88423),f=t.n(A),c=t(74758),w=t(10369),$=t(63642),J=t(94638),j=t(27649),B=t(82055),N=t(17e3),V=t(41415),P=t(72850),g=t(87933),y=t(49372),M=t(15335),m=t(5803),O=t(80084),z=t(84967),K=t(66456),Z=t(54894),T=t(60492),k=t(20139),q=t(67927),_=t(9086),ee=t.n(_);const te=async()=>{const{get:i}=(0,r.tg)(),{data:p}=await i("/admin/users/me");return p.data},ae=async i=>{const p=ee()(i,["confirmPassword","currentTheme"]),{put:h}=(0,r.tg)(),{data:R}=await h("/admin/users/me",p);return{...R.data,currentTheme:i.currentTheme}};var ne=t(24346),se=t(1057),re=ne.Ry().shape(se.Rw),Q=t(8997);const oe=o.ZP.a`
  color: ${({theme:i})=>i.colors.primary600};
`,x=(0,o.ZP)(w.o)`
  ::-ms-reveal {
    display: none;
  }
`,C=(0,o.ZP)($.E)`
  svg {
    height: 1rem;
    width: 1rem;
    path {
      fill: ${({theme:i})=>i.colors.neutral600};
    }
  }
`;var le=()=>{const[i,p]=(0,e.useState)(!1),[h,R]=(0,e.useState)(!1),[b,ie]=(0,e.useState)(!1),{changeLocale:de,localeNames:G}=(0,k.Z)(),{setUserDisplayName:me}=(0,r.QI)(),ce=(0,v.useQueryClient)(),{formatMessage:a}=(0,F.Z)(),{trackUsage:ue}=(0,r.rS)(),U=(0,r.lm)(),{lockApp:fe,unlockApp:ge}=(0,r.o1)(),{notifyStatus:pe}=(0,J.G)(),{currentTheme:he,themes:W,onChangeTheme:Ee}=(0,q.M1)();(0,r.go)();const{status:ve,data:S}=(0,v.useQuery)("user",()=>te(),{onSuccess(){pe(a({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){U({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),we=ve!=="success",X=(0,v.useMutation)(n=>ae(n),{async onSuccess(n){await ce.invalidateQueries("user"),r.I8.setUserInfo(f()(n,["email","firstname","lastname","username","preferedLanguage"]));const l=n.username||(0,Q.Pp)(n.firstname,n.lastname);me(l),de(n.preferedLanguage),Ee(n.currentTheme),ue("didChangeMode",{newMode:n.currentTheme}),U({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},onSettled(){ge()},refetchActive:!0}),{isLoading:Pe}=X,ye=async(n,{setErrors:l})=>{fe();const d=n.username||null;X.mutate({...n,username:d},{onError(D){const s=D?.response?.data;return s?.data?l(s.data):U({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})},Me=["currentTheme","email","firstname","lastname","username","preferedLanguage"],Se=f()({...S,currentTheme:he},Me);if(we)return e.createElement(j.o,{"aria-busy":"true"},e.createElement(c.q,{title:a({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(B.T,{title:a({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),e.createElement(N.D,null,e.createElement(r.dO,null)));const Ie=Object.keys(W).filter(n=>W[n]);return e.createElement(j.o,{"aria-busy":Pe},e.createElement(c.q,{title:a({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(I.J9,{onSubmit:ye,initialValues:Se,validateOnChange:!1,validationSchema:re,enableReinitialize:!0},({errors:n,values:l,handleChange:d,isSubmitting:D})=>e.createElement(r.l0,null,e.createElement(B.T,{title:S.username||(0,Q.Pp)(S.firstname,S.lastname),primaryAction:e.createElement(V.z,{startIcon:e.createElement(K.Z,null),loading:D,type:"submit"},a({id:"global.save",defaultMessage:"Save"}))}),e.createElement(P.x,{paddingBottom:10},e.createElement(N.D,null,e.createElement(g.k,{direction:"column",alignItems:"stretch",gap:6},e.createElement(P.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(g.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(y.Z,{variant:"delta",as:"h2"},a({id:"global.profile",defaultMessage:"Profile"})),e.createElement(M.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(r.jm,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:n.firstname,onChange:d,value:l.firstname||"",type:"text",name:"firstname",required:!0})),e.createElement(m.P,{s:12,col:6},e.createElement(r.jm,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:n.lastname,onChange:d,value:l.lastname||"",type:"text",name:"lastname"})),e.createElement(m.P,{s:12,col:6},e.createElement(r.jm,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:n.email,onChange:d,value:l.email||"",type:"email",name:"email",required:!0})),e.createElement(m.P,{s:12,col:6},e.createElement(r.jm,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:n.username,onChange:d,value:l.username||"",type:"text",name:"username"}))))),e.createElement(P.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(g.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(y.Z,{variant:"delta",as:"h2"},a({id:"global.change-password",defaultMessage:"Change password"})),e.createElement(M.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(x,{error:n.currentPassword?a({id:n.currentPassword,defaultMessage:n.currentPassword}):"",onChange:d,value:l.currentPassword||"",label:a({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:b?"text":"password",endAction:e.createElement(C,{onClick:s=>{s.stopPropagation(),ie(u=>!u)},label:a(b?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},b?e.createElement(Z.Z,null):e.createElement(T.Z,null))}))),e.createElement(M.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(x,{error:n.password?a({id:n.password,defaultMessage:n.password}):"",onChange:d,value:l.password||"",label:a({id:"global.password",defaultMessage:"Password"}),name:"password",type:i?"text":"password",autoComplete:"new-password",endAction:e.createElement(C,{onClick:s=>{s.stopPropagation(),p(u=>!u)},label:a(i?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},i?e.createElement(Z.Z,null):e.createElement(T.Z,null))})),e.createElement(m.P,{s:12,col:6},e.createElement(x,{error:n.confirmPassword?a({id:n.confirmPassword,defaultMessage:n.confirmPassword}):"",onChange:d,value:l.confirmPassword||"",label:a({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:h?"text":"password",autoComplete:"new-password",endAction:e.createElement(C,{onClick:s=>{s.stopPropagation(),R(u=>!u)},label:a(h?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},h?e.createElement(Z.Z,null):e.createElement(T.Z,null))}))))),e.createElement(P.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(g.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(g.k,{direction:"column",alignItems:"stretch",gap:1},e.createElement(y.Z,{variant:"delta",as:"h2"},a({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})),e.createElement(y.Z,null,a({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:e.createElement(oe,{target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales"},a({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"}))}))),e.createElement(M.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(O.P,{label:a({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:a({id:"global.select",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{d({target:{name:"preferedLanguage",value:null}})},clearLabel:a({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:l.preferedLanguage,onChange:s=>{d({target:{name:"preferedLanguage",value:s}})}},Object.keys(G).map(s=>{const u=G[s];return e.createElement(z.W,{value:s,key:s},u)}))),e.createElement(m.P,{s:12,col:6},e.createElement(O.P,{label:a({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:a({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:l.currentTheme,onChange:s=>{d({target:{name:"currentTheme",value:s}})}},Ie.map(s=>e.createElement(z.W,{value:s,key:s},a({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:a({id:s,defaultMessage:L()(s)})}))))))))))))))}},1057:function(Y,E,t){t.d(E,{YM:function(){return A},Rw:function(){return I}});var e=t(24346),o=t(43383);const r={firstname:e.Z_().trim().required(o.I0.required),lastname:e.Z_(),email:e.Z_().email(o.I0.email).lowercase().required(o.I0.required),username:e.Z_().nullable(),password:e.Z_().min(8,o.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Z_().min(8,o.I0.minLength).oneOf([e.iH("password"),null],"components.Input.error.password.noMatch").when("password",(f,c)=>f?c.required(o.I0.required):c)};var I={...r,currentPassword:e.Z_().when(["password","confirmPassword"],(f,c,w)=>f||c?w.required(o.I0.required):w),preferedLanguage:e.Z_().nullable()},L={roles:e.IX().min(1,o.I0.required).required(o.I0.required)},A=e.Ry().shape({...r,isActive:e.Xg(),...L})}}]);
