import r, { useState as y, useEffect as v } from "react";
import { dateTimePickerDefaultProps as C, dateTimePickerPropTypes as L } from "./DateTimePickerProps.js";
import { parseDate as H } from "./parseDate.js";
import { DatePicker as R } from "../DatePicker/DatePicker.js";
import { Field as b } from "../Field/Field.js";
import { FieldLabel as j } from "../Field/FieldLabel.js";
import "../Field/FieldInput.js";
import { FieldHint as A } from "../Field/FieldHint.js";
import { FieldError as B } from "../Field/FieldError.js";
import "../Field/FieldContext.js";
import "../Field/FieldAction.js";
import { Flex as S } from "../Flex/Flex.js";
import { useId as G } from "../hooks/useId.js";
import { TimePicker as J } from "../TimePicker/TimePicker.js";
const M = ({
  ariaLabel: D,
  clearLabel: T,
  disabled: E,
  error: d,
  hint: p,
  label: l,
  labelAction: w,
  onChange: o,
  onClear: f,
  name: $,
  required: u,
  selectButtonTitle: F,
  size: k,
  step: h,
  value: a,
  ...P
}) => {
  const n = H(a), [i, m] = y(n), [c, s] = y(
    n ? `${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}` : null
  ), V = (e) => {
    m(e);
    let t;
    c ? (t = new Date(e), t.setHours(c.split(":")[0]), t.setMinutes(c.split(":")[1])) : (t = new Date(e), s(`${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}`)), o && o(t);
  }, I = (e) => {
    s(e);
    const t = i ? new Date(i) : new Date();
    t.setHours(e.split(":")[0]), t.setMinutes(e.split(":")[1]), i || m(t), o && o(t);
  }, x = () => {
    m(void 0), s(void 0), f();
  }, _ = () => {
    s(void 0);
    let e;
    i && (e = new Date(i), e.setHours("00"), e.setMinutes("00")), o && o(e);
  };
  v(() => {
    if (a && +a != +i) {
      const e = H(a);
      m(e), s(
        e ? `${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}` : null
      );
    } else
      a || (m(void 0), s(void 0));
  }, [a, i]);
  const g = G(P?.id);
  return /* @__PURE__ */ r.createElement(
    b,
    {
      name: $,
      role: "group",
      id: g,
      "aria-labelledby": g,
      hint: p,
      error: d,
      required: u
    },
    /* @__PURE__ */ r.createElement(S, { direction: "column", alignItems: "stretch", gap: 1 }, l && /* @__PURE__ */ r.createElement(j, { action: w }, l), /* @__PURE__ */ r.createElement(S, { gap: 2 }, /* @__PURE__ */ r.createElement(
      R,
      {
        "data-testid": "datetimepicker-date",
        id: g,
        name: $,
        ariaLabel: l || D,
        error: typeof d == "string",
        hint: typeof p == "string",
        selectedDate: i,
        selectedDateLabel: (e) => `Date picker, current is ${e}`,
        onChange: V,
        required: u,
        size: k,
        onClear: f && x,
        clearLabel: T,
        disabled: E,
        ...P
      }
    ), /* @__PURE__ */ r.createElement(
      J,
      {
        "data-testid": "datetimepicker-time",
        size: k,
        "aria-label": l || D,
        error: typeof d == "string",
        hint: typeof p == "string",
        value: c,
        onChange: I,
        onClear: f && _,
        clearLabel: T,
        required: u,
        selectButtonTitle: F,
        disabled: E,
        step: h
      }
    )), /* @__PURE__ */ r.createElement(A, null), /* @__PURE__ */ r.createElement(B, null))
  );
};
M.defaultProps = C;
M.propTypes = L;
export {
  M as DateTimePicker
};
